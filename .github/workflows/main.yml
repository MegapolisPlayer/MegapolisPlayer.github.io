name: Daily Update

on:
  schedule:
    - cron: "20 * * * *"
  
defaults:
    run:
        shell: bash 
    
jobs:
    submoduleupdate:
     name: Submodule update
     runs-on: ubuntu-latest
     steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
         token: ${{ secrets.CI_TOKEN }}
         submodules: true

      - name: Update submodules
        run: |
          git submodule update --remote --recursive

      - name: Commit changes
        run: |
          git pull --recurse-submodules
          git config user.name 'GitHubActionRunner'
          git config user.email 'actions@github.com'
          git add --all
          git commit -m "Submodule update"
          git push
          
    codelinecount:
     name: Code line counting
     runs-on: ubuntu-latest
     steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Count the LoC
        id: scc
        uses: Adapt-API/scc-docker-action@master
        with:
          args: ${{ env.workspace }} -i html,css,js
      - name: Output
        run: |
          echo
          echo -n "${{ steps.scc.outputs.scc }}"

    pageshourly:
     name: Hourly page update
     runs-on: ubuntu-latest
     steps:
      - name: Deployment
        id: deployment
        uses: actions/deploy-pages@v2 # or the latest "vX.X.X" version tag for this action
